#!/usr/bin/env python

import logging, optparse, os, sys

PROJECT_DIR = os.path.expanduser('~/work/yed/')

logging.basicConfig(stream=sys.stderr, level=logging.DEBUG)
LOG = logging.getLogger(__name__)


def pygrep(opts, args):
    cmd = (
        "find {0} -type f | egrep '{1}'"
        " | xargs egrep '{2}'".format(
            PROJECT_DIR,
            opts.suffixpat,
            args[0],
            )
        )
    LOG.debug('cmd = %s', cmd)
    print os.popen(cmd).read()


def main():
    parser = optparse.OptionParser()
    parser.add_option("-w", "--web", dest="type_web", action="store_true")

    (options, args) = parser.parse_args()
    options.suffixpat = r'(js|html)$' if options.type_web else r'py$'
    pygrep(options, args)


if __name__=='__main__':
    main()
